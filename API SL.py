import ssl
import suds
import datetime

try:
    _create_unverified_https_context = ssl._create_unverified_context
except AttributeError:
    pass
else:
    ssl._create_default_https_context = _create_unverified_https_context

#data=datetime.datetime.strptime('2019-07-01','%Y-%m-%d').isoformat()

def main():
    while True:
        metoda=int(input("Wybierz metodę\n1 - MaterialAllOfflineGetStock\n2 - MaterialOfflineGetStock\n3 - MaterialGetStock\n"))
        if metoda==1:
            MaterialAllOfflineGetStock()
        if metoda==2:
            MaterialOfflineGetStock()
        if metoda==3:
            MaterialGetStock()

def pobranie_ilosci_stron(metoda,parms):
    results=eval(r'suds.basestring(client.service.{}({})).split("\n")'.format(metoda,parms))
    ilosc_stron=int(results[3][results[3].find('=')+1:])
    return ilosc_stron

def MaterialAllOfflineGetStock():
    pages=pobranie_ilosci_stron('MaterialAllOfflineGetStockInfo',parms={'GroupedCodeType':'p'})
    symkar=input("Podaj Symkar: ").replace(" ","")
    i=1
    flag=0
    while i<=pages and flag<2:
        parms={'Page':i,'GroupedCodeType':'p'}
        results=suds.basestring(client.service.MaterialAllOfflineGetStock(parms)).split(",")
        for result in results:
            if result.find(symkar) != -1:
                flag+=1
                print("Jestem na stronie: {}/{}\n".format(i,pages))
                print(result,'\n')
        i+=1
    else:
        print("Koniec działania programu")

def MaterialOfflineGetStock():
    data=datetime.datetime.strptime(input("Podaj datę w formacie YYYY-MM-DD: "),'%Y-%m-%d').isoformat()
    pages=pobranie_ilosci_stron('MaterialOfflineGetStockInfo',parms={'DateFrom':data,'GroupedCodeType':'p'})
    symkar=input("Podaj Symkar: ").replace(" ","")
    i=1
    flag=0
    while i<=pages and flag<2:
        parms={'DateFrom':data,'Page':i,'GroupedCodeType':'p'}
        results=suds.basestring(client.service.MaterialOfflineGetStock(parms)).split(",")
        for result in results:
            if result.find(symkar) != -1:
                flag+=1
                print("Jestem na stronie: {}/{}\n".format(i,pages))
                print(result,'\n')
        i+=1
    else:
        print("Koniec działania programu")

def MaterialGetStock():
    symkar=input("Podaj Symkar: ").replace(" ","")
    i=1
    while i<=2:
        parms={'MaterialCode':symkar}
        results=suds.basestring(client.service.MaterialGetStock(parms))
        print("\n",results,"\n")

def test():
    pages=pobranie_ilosci_stron('MaterialAllOfflineGetStockInfo')
    lista="1325087,1277240,1351609,1316269,1323389,1246791,1322396,1263755,1315896,1263704,1265695,1308094,1324874,1346098,1307874,1327592,1259529,1327250,1242405,1258351,1314352,1318029,1306524,1324586,1246012,1252720,1355356,1326820,1257585,1328442,1324119,1326584,1258331,1327434,1261559,1325134,1263526,1327016,1264580,1273428,1329223,1239644,1328118,1249174,1323724,1261563,1317235,1315775,1351612,1307728,1282651,1320148,1237923,1318059,1311362,1273014,1279636,1325776,1311735,1318565,1356205,1340538,1327245,1252312,1331747,1320359,1242483,1270722,1329006,1311748,1308508,1328130,1301943,1324936,1259175,1265742,1263778,1258845,1323435,1327001,1326727,1312917,1279576,1259959,1287218,1299170,1312387,1311750,1274373,1277002,1302683,1258436,1315454,1353251,1304449,1265836,1257686,1350649,1327327,1249295,1308502,1309247,1326730,1309821,1322496,1308611,1316705,1329889,1264864,1328178,1335928,1326995,1246681,1315770,1311877,1263638,1235681,1236250,1265882,1258628,1332116,1272710,1292392,1282682,1239573,1259001,1289779,1250571,1279575,1329412,1298337,1270720,1326846,1289790,1353954,1259594,1284430,1308644,1250591,1271064,1264828,1235863,1258566,1290347,1259600,1313374,1308453,1314079,1249278,1242484,1259241,1258398,1353419,1353250,1322394,1291804,1264480,1281590,1274621,1283358,1263758,1320393,1353120,1320395,1283785,1237735,1249021,1326731,1311732,1326728,1326193,1324957,1263681,1278778,1307735,1263794,1313126,1308517,1317167,1322697,1259233,1315475,1348115,1263599,1289792,1237808,1235864,1263648,1327753,1329015,1340915,1347371,1240345,1294158,1347383,1258688,1252661,1329477,1277034,1316446,1265722,1320147,1259974,1263533,1247026,1266485,1320397,1270839,1249279,1250659,1247014,1316859,1297949,1351589,1327756,1258767,1306511,1246790,1261702,1291499,1265991,1326045,1289815,1293477,1258453,1324581,1328408,1264944,1302673,1296939,1252721,1274341,1250652,1322901,1309167,1311722,1258168,1239570,1316714,1258333,1247001,1309164,1308701,1240051,1279210,1258745,1235510,1246956,1258766,1311730,1252933,1249563,1353265,1236024,1282675,1277434,1347524,1315686,1306623,1315904,1272720,1293474,1292431,1240591,1292438,1242663,1307873,1291500,1239258,1252659,1319508,1319364,1258763,1259519,1306525,1273069,1274400,1306521,1312481,1301118,1276989,1303196,1249233,1275627,1328796,1307543,1325687,1347725,1286793,1343489,1308746,1317524,1351579,1317644,1336044,1258226,1289786,1250663,1311734,1284426,1322589,1249296,1249284,1313860,1351630,1324374,1324848,1285634,1312519,1322965,1336089,1308511,1277957,1236606,1246678,1264587,1259523,1283360,1302172,1317975,1282659,1326477,1263528,1257546,1277760,1327278,1347520,1308601,1235668,1317168,1279633,1313774,1316372,1247013,1259596,1263598,1328188,1356919,1315545,1252931,1323721,1239422,1317691,1315759,1357484,1246789,1325790,1350282,1310416,1273409,1261667,1323927,1312361,1258525,1326845,1258360,1235774,1237987,1353422,1292413,1290648,1311749,1328000,1295147,1307869,1316832,1307871,1315465,1264939,1306514,1243964,1324938,1289782,1313519,1312535,1306509,1261737,1328001,1313530,1250492,1258520,1285130,1250653,1326234,1252670,1351613,1324118,1326237,1328402,1327685,1261688,1289646,1252938,1292407,1301194,1315481,1303119,1342494,1336091,1349663,1317095,1324583,1325196,1296821,1291409,1322212,1242588,1265557,1336088,1272721,1313876,1313858,1251504,1336100,1324646,1258160,1323713,1282654,1324021,1325791,1308114,1309910,1291378,1265848,1258746,1322500,1263516,1274714,1258144,1263602,1259030,1325025,1239336,1326359,1316367,1262638,1280194,1316432,1265993,1287646,1303213,1260036,1318617,1323262,1297374,1258350,1353126,1299373,1301274,1287310,1291463,1264621,1313092,1324868,1251491,1263780,1308112,1256822,1310639,1359369,1258701,1308442,1319505,1295686,1292174,1308700,1311744,1309735,1289817,1253344,1312536,1264894,1314562,1323653,1322917,1258778,1265637,1277804,1312533,1249292,1263662,1259590,1246792,1283955,1353117,1258950,1263760,1258894,1276980,1292400,1322959,1251515,1301777,1327594,1284006,1264607,1259246,1265681,1344722,1240510,1259237,1329888,1315198,1325146,1263625,1263727,1246676,1347518,1327757,1311751,1325581,1263787,1258597,1316656,1358239,1289802,1313284,1351607,1249281,1272902,1258155,1336012,1336243,1326994,1258148,1298333,1342680,1263776,1286799,1335989,1300757,1259162,1340544,1326194,1239557,1246988,1291358,1246682,1304389,1274713,1250657,1282281,1258340,1316621,1308106,1317481,1278729,1289787,1316223,1319360,1274758,1246796,1327256,1326948,1324866,1258325,1340539,1351594,1264502,1320150,1308109,1279208,1311737,1242642,1239744,1351595,1316541,1304145,1320360,1263545,1325873,1319365,1239929,1301103,1264498,1340909,1246807,1316439,1325575,1258756,1303849,1264935,1286805,1306531,1306526,1263795,1320394,1286790,1328429,1328281,1326764,1306523,1316284,1296054,1289649,1307872,1258221,1313780,1329409,1306884,1291237,1252657,1277046,1236277,1320149,1313524,1296955,1311752,1340917,1291458,1265721,1327752,1289793,1312468,1326795,1252953,1324876,1295156,1259904,1311727,1237683,1320145,1326349,1265837,1257315,1316451,1261566,1320396,1258861,1291939,1244843,1322414,1276956,1246809,1259121,1324436,1246008,1306438,1322265,1292444,1322899,1346211,1323399,1303287,1237873,1320151,1308506,1347652,1249560,1317061,1265849,1356920,1258997,1308509,1327013,1307734,1313370,1356236,1316543,1240507,1263689,1302744,1317278,1258531,1273419,1274767,1292397,1258330,1277991,1259953,1316477,1252625,1317488,1310172,1274244,1324582,1296956,1294597,1239432,1340554,1336052,1326439,1326732,1316289,1336090,1247011,1309477,1358231,1328211,1307946,1278864,1246998,1291196,1240268,1313517,1252722,1328229,1327435,1327643,1323383,1302684,1274757,1315455,1249554,1326921,1340541,1316860,1249289,1313534,1252580,1356328,1246270,1287647,1328885,1274308,1296846,1265736,1329890,1316264,1328199,1311743,1266007,1242638,1316831,1324010,1265832,1306513,1264551,1311725,1300108,1316770,1324378,1351584,1327176,1320575,1312454,1244533,1258546,1258859,1304948,1265767,1278719,1311746,1289797,1258138,1251427,1256836,1308108,1311570,1325593,1258363,1313839,1259533,1236261,1251613,1316835,1280702,1295685,1263764,1303512,1263789,1236646,1258801,1242432,1327437,1305466,1291451,1258562,1330257,1282416,1236229,1347579,1336006,1258987,1246962,1235666,1312691,1258629,1347523,1319507,1353455,1322514,1252871,1296760,1312534,1356243,1263782,1310137,1320392,1250656,1317460,1308702,1316177,1258725,1258565,1258619,1264932,1300482,1351616,1264792,1308313,1325426,1322511,1259555,1303281,1309171,1239702,1325698,1309830,1308455,1298049,1296957,1258128,1316700,1306770,1317284,1299616,1356917,1258467,1276987,1306510,1249276,1276367,1326996,1258805,1236668,1317003,1236643,1264631,1296937,1316212,1258352,1283362,1279942,1252644,1277237,1302287,1292411,1264589,1264627,1308606,1246298,1353264,1264586,1322412,1284472,1297950,1326413,1235530,1246004,1308491,1264913,1308095,1353435,1263600,1246795,1265948,1314417,1313127,1325027,1316220,1327033,1281466,1359580,1305761,1236623,1277707,1258771,1324355,1323408,1253345,1264553,1297224,1325785,1258530,1275423,1317822,1324579,1287058,1337285,1258574,1359441,1308603,1287059,1264501,1249128,1311738,1303838,1265754,1259988,1311238,1323671,1318686,1324684,1259258,1308514,1313531,1258483,1313287,1258381,1351622,1344724,1319512,1308484,1276380,1326712,1303720,1323775,1315898,1264856,1236669,1312513,1252547,1252593,1324896,1250583,1316721,1324867,1314546,1351634,1250585,1244205,1319847,1323059,1235362,1312748,1245512,1316927,1309924,1327549,1327428,1315211,1252926,1326710,1244121,1259603,1306801,1263663,1306517,1335988,1264934,1256832,1308107,1242481,1277768,1323732,1274309,1311138,1322492,1308602,1263796,1285129,1264506,1279637,1326770,1318593,1258776,1242482,1317538,1324001,1328487,1246793,1251492,1317011,1306929,1298508,1317012,1312531,1239939,1326729,1236688,1298596,1303794,1308409,1308510,1329887,1352896,1291380,1327002,1327330,1265897,1298335,1302389,1291403,1252929,1258633,1328497,1312386,1262744,1269688,1296700,1327252,1274711,1325984,1252660,1259558,1246801,1315687,1351624,1322958,1251450,1236361,1324954,1271260,1258765,1311739,1258358,1263555,1329465,1238004,1308516,1327438,1249280,1306527,1253104,1258788,1236647,1258254,1291369,1312692,1246794,1239583,1324707,1327755,1258705,1242505,1236627,1266479,1289648,1258721,1244198,1275438,1293081,1236636,1247012,1353513,1307877,1263759,1323723,1328282,1343437,1322863,1356362,1347651,1235721,1308431,1316853,1264910,1308607,1356921,1277854,1345609,1296725,1328484,1263527,1316474,1312739,1328518,1289794,1264918,1258576,1307945,1246299,1289820,1276927,1237765,1258652,1266523,1305401,1263684,1307626,1252313,1351640,1317980,1282657,1326928,1264612,1258271,1246996,1313305,1289821,1244842,1258461,1320146,1258348,1258460,1325701,1326998,1240343,1261556,1263679,1323670,1354739,1244126,1263761,1315484,1351629,1325023,1306516,1273405,1270494,1353249,1346102,1252652,1317185,1303286,1317233,1263785,1353286,1246673,1316697,1340548,1242507,1277710,1275107,1276397,1346206,1249282,1263767,1335272,1270590,1327251,1322509,1291383,1258610,1302858,1289784,1265778,1257986,1336064,1260313,1327644,1353436,1289643,1265738,1277224,1246683,1259598,1264800,1283359,1258685,1340553,1322506,1324217,1311355,1263604,1326976,1260043,1270985,1258159,1252645,1319506,1239168,1311728,1235747,1325886,1279897,1344607,1274340,1322415,1258387,1302280,1235744,1322900,1328798,1329426,1258462,1298336,1252671,1343141,1320152,1258400,1289791,1264588,1272713,1324376,1311358,1302346,1289801,1336046,1307733,1334770,1289804,1261565,1258511,1309158,1313838,1258393,1346104,1324389,1328440,1347372,1247024,1258183,1313807,1323193,1306444,1313528,1353244,1258337,1307727,1278727,1328405,1251505,1235679,1258353,1306515,1270781,1273729,1329499,1276928,1252930,1311236,1316275,1325655,1235639,1295176,1263550,1261706,1246680,1237865,1359668,1337277,1237690,1326166,1307870,1326513,1303125,1315438,1258376,1310297,1357474,1351599,1311726,1287649,1313408,1325022,1306656,1239658,1263450,1303827,1252903,1325740,1258586,1285337,1252622,1246958,1291371,1357481,1314414,1322960,1258164,1351605,1316600,1324491,1280538,1272714,1314474,1239887,1295217,1250664,1258769,1308497,1312532,1289642,1306519,1300136,1359366,1265648,1283793,1322510,1323316,1252928,1273407,1265724,1313518,1263543,1246997,1293475,1320573,1326824,1312529,1308646,1322622,1346103,1258503,1265833,1315439,1258452,1312494,1235528,1322967,1263771,1323673,1264862,1324375,1289795,1263714,1325586,1311747,1265812,1316851,1258792,1252701,1321856,1317192,1294894,1357434,1249226,1314421,1323257,1285414,1302286,1357494,1291452,1321858,1249294,1252621,1258793,1322903,1264098,1240593,1333582,1306428,1320933,1297355,1326821,1324539,1326183,1316826,1263774,1282676,1312500,1323885,1286792,1316704,1252646,1316430,1324578,1328886,1273397,1237837,1308609,1326252,1273414,1250602,1294259,1328788,1246300,1263435,1259569,1264787,1325656,1262650,1250654,1252691,1263508,1258600,1292391,1299470,1258372,1264942,1323225,1278748,1300940,1356046,1306926,1264592,1336779,1325473,1257474,1263554,1259157,1265714,1246797,1249286,1357508,1324417,1307986,1290958,1263443,1309909,1359110,1312388,1353239,1330256,1262822,1317277,1321692,1297951,1258681,1259164,1323678,1313282,1272724,1351642,1273013,1340543,1359903,1336036,1328438,1325723,1313927,1353134,1265873,1324875,1289803,1340549,1258476,1308331,1296630,1351106,1279774,1290430,1235973,1279187,1322942,1236644,1258465,1322904,1258380,1271044,1291249,1278849,1323381,1357492,1306683,1316285,1314754,1311741,1264777,1316542,1303266,1289789,1303486,1327684,1326822,1249130,1258764,1308760,1258334,1240594,1251528,1327595,1351626,1308608,1264602,1326411,1328789,1325781,1301381,1259563,1315783,1257283,1276386,1312362,1263511,1258797,1312300,1261567,1297948,1272718,1313373,1258704,1259144,1328441,1296628,1287953,1315798,1265690,1306520,1322275,1258648,1289818,1249566,1250650,1308767,1328068,1242633,1314379,1244119,1329479,1249223,1273742,1312475,1336045,1252656,1244846,1250655,1276783,1306512,1252939,1308604,1258506,1326120,1284272,1322283,1252655,1325024,1235684,1292427,1322964,1234831,1252934,1252612,1325743,1252672,1326190,1246013,1308082,1314832,1311515,1238373,1246800,1310152,1275162,1284287,1264558,1311874,1330262,1258170,1316540,1284050,1309449,1327144,1244985,1252942,1274846,1322504,1250504,1308610,1327248,1326847,1358594,1258916,1311742,1289645,1310412,1317703,1327341,1263678,1263531,1235680,1290959,1322501,1239558,1265803,1309393,1306522,1264941,1258126,1308513,1331727,1280537,1258205,1313840,1290957,1276988,1257569,1275117,1336014,1246016,1329318,1270410,1271049,1258622,1274628,1235728,1263551,1328794,1311736,1291342,1353231,1322404,1252667,1244231,1337275,1247036,1302173,1264595,1291379,1308641,1316975,1260044,1242610,1326726,1315228,1258447,1252573,1258690,1296958,1306518,1308605,1309248,1314198".split(",")
    for list in lista:
        print("Symkar: ",list)
        i=1
        flag=0
        while i<=pages and flag<2:
            parms={'Page':i,'GroupedCodeType':'p'}
            results=suds.basestring(client.service.MaterialAllOfflineGetStock(parms)).split(",")
            for result in results:
                if result.find(list) != -1:
                    flag+=1
                    print(result,'\n')
            i+=1

url=r"https://10.1.1.15/ERP_PROD_PROD/services_integration_api/ApiWebService.ashx?wsdl&DBC=ECOM_PROD"
client=suds.Client(url,timeout=999999)
main()

